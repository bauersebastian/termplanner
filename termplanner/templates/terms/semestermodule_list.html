{% extends "base.html" %}
{% block content %}
  <div class="container">
    <div class="row">
      <div class="col">
        <h1>Meine Semester</h1>
      </div>
    </div>
    <div class="row">
      <div class="col">
        {% if semestermodule_list_current %}
          <h2>Aktuell belegte Module</h2>
          <table class="table mt-4">
            <thead class="table_vawi">
              <tr>
                <th scope="col">Modulbezeichnung</th>
                <th scope="col">ECTS</th>
                <th scope="col">Note</th>
                <th scope="col">Nächste offene Ereignisse</th>
              </tr>
            </thead>
            <tbody>
            {% for semestermodule in semestermodule_list_current %}
              <tr>
                <th scope="row"><a href="{% url 'terms:detail' semestermodule.id %}">{{semestermodule.module.title}}</a></th>
                <td>{{ semestermodule.module.ects }}</td>
                {% if semestermodule.grade != None %}
                  <td>{{ semestermodule.grade }}</td>
                {% else %}
                  <td>-</td>
                {% endif %}
                <td>
                  <ul class="list-group list-group-flush">
                    {% for event in semestermodule.events.all %}
                      {% if event.done == False %}
                        <li class="list-group-item"><a href="{% url 'terms:detail_event' semestermodule.id event.id %}">{{ event.start_date }} - {{ event.title }}</a> </li>
                      {% endif %}
                    {% endfor %}
                  </ul>
                </td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
          {% else %}
            <p>Du hast noch kein Modul hinterlegt, welches du aktuell belegst. Füge doch gleich eines hinzu.</p>
          {% endif %}
      </div>
    </div>

    <div class="row">
      <div class="col">
        <a class="btn btn-secondary float-right" role="button" href="{% url "terms:add"%}">
          Modul hinzufügen
        </a>
      </div>
    </div>

    <div class="row">
      <div class="col">
        {% if semestermodule_list_done %}
          <h2>Abgeschlossene Module</h2>
          <table class="table mt-4">
            <thead class="table_vawi">
              <tr>
                <th scope="col">Modulbezeichnung</th>
                <th scope="col">ECTS</th>
                <th scope="col">Note</th>
              </tr>
            </thead>
            <tbody>
            {% for semestermodule in semestermodule_list_done %}
              <tr>
                <th scope="row"><a href="{% url 'terms:detail' semestermodule.id %}">{{semestermodule.module.title}}</a></th>
                <td>{{ semestermodule.module.ects }}</td>
                {% if semestermodule.grade != None %}
                  <td>{{ semestermodule.grade }}</td>
                {% else %}
                  <td>-</td>
                {% endif %}
              </tr>
            {% endfor %}
            </tbody>
          </table>
          {% else %}
            <p>Du hast leider noch keine abgeschlossenen Module.</p>
          {% endif %}
        <p>Du hast bereits {{ semestermodule_list_done.count }}
          {% if semestermodule_list_done.count == 1 %}Modul {% else %}Module {% endif %}abgeschlossen.
        </p>
        <p>Somit hast du bisher {{ ects_done.module__ects__sum }} ECTS Punkte gesammelt.</p>

      </div>
    </div>
  </div>

{% endblock %}
